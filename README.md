# 线程池

## 1. 项目简介

WorkQueue 是一个基于C++17的轻量级线程池实现。它解决了在多线程编程中频繁创建和销毁线程带来的性能开销问题，通过预创建线程并复用线程资源，提供高效的异步任务执行能力。

**核心解决的问题**：
- 避免频繁线程创建/销毁的系统开销
- 提供统一的异步任务提交接口
- 支持多种同步策略以适应不同场景
- 简化并发编程的复杂度

## 2. 主要功能说明

### 2.1 异步任务执行
- 支持提交任意可调用对象（函数、Lambda表达式、函数对象）
- 通过模板技术实现类型安全的接口
- 自动处理任务参数绑定和转发

### 2.2 多种互斥策略
- **无锁模式 (None)**：适用于单生产者-单消费者场景
- **自旋锁模式 (Spin)**：适合短临界区、高频率争用场景
- **互斥锁模式 (Mutex)**：通用并发场景，线程会阻塞等待

### 2.3 Future/Promise 模式
- 通过`std::future`获取任务执行结果
- 支持异常传播，任务中的异常可传递到调用方
- 提供任务执行状态的查询和等待

### 2.4 线程安全
- 线程安全的任务队列操作
- 内置同步机制防止数据竞争
- 支持多线程并发提交任务

## 3. 项目目录结构解释
my-project/
├── include/ # 公共头文件目录
│ ├── lthread.h # 线程基类定义
│ └── workqueue.h # 工作队列主接口
├── src/ # 源代码目录
│ ├── core/ # 核心实现
│ │ ├── lthread.cpp # 线程基类实现
│ │ ├── workqueue.cpp # 工作队列实现
│ │ └── main.cpp # 示例程序
│ └── util/ # 工具模块
│ └── spinmutex.hpp # 自旋锁实现
├── CMakeLists.txt # CMake构建配置
└── README.md # 项目说明文档

**目录结构说明**：
- `include/`：包含项目的公共接口，供其他模块引用
- `src/core/`：核心实现代码，包含线程池的主要逻辑
- `src/util/`：工具类实现，如自旋锁等底层同步原语
- `CMakeLists.txt`：项目构建配置文件，定义编译规则和依赖

## 4. 构建方式与运行方式

### 4.1 构建步骤
#创建构建目录
mkdir build
cd build
#配置项目
cmake ..
#使用CMake构建命令
cmake --build .

### 4.2 运行示例程序
#运行编译生成的可执行文件
./bin/my-project